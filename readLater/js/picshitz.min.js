"use strict";$().ready(function(){var f=window.nadir.readLater,s=window.location.get("password"),n=window.location.get("uid"),r=function(n){return n.match(/picshitz/gi)},t=function(t){var r=$(document.createElement("li")).addClass(t.error?"ui-state-error":undefined).append($(document.createElement("div")).addClass("title").append($(document.createElement("div")).addClass("title").append($(document.createElement("img")).addClass("favicon").data({url:t.href})).append($(document.createElement("div")).addClass("title").text(t.title)))).append($(document.createElement("div")).addClass("row").append($(document.createElement("div")).addClass("link").append($(document.createElement("a")).attr({href:t.href,target:"_blank"}).text(t.href))).append($(document.createElement("div")).addClass("buttons").append(t.error?undefined:$(document.createElement("button")).addClass("ui-state-highlight").addClass("add").attr({type:"button"}).button({icons:{primary:"ui-icon-disk"},label:"Add to Read Later"}).data({title:t.title,url:t.href}).on({click:function(){var r=$(this).closest("button"),t=r.data();$.confirm("Are you sure you want to add '{0}'?".format(t.title&&t.title.length?t.title:t.url)).then(function(){f.add({uid:n,href:t.url,title:t.title,category:"picshitz",callback:function(n){n?i(n.description||n.message||n):$.toast.message("Saved!")}})})}})))).appendTo($("#list").find("ul"));f.loadFavicons(r)},i=function(n){window.jQuery.toast.error(n)},u=function(n,r){i("Invalid source page!");t({error:!0,href:n,title:"Invalid "+r})},e=function(n){window.loader.value(!1);window.loading(function(){return $.get(window.location.sameProtocol("api.allorigins.win/raw")+"?url="+n).then(function(n){var u={};$(document.createElement("div")).html(n.replace(/ src="/gi,' data-src="')).find(".postBody a").each(function(){var t=$(this).attr("href"),n;r(t)&&(n=o(t))&&n.length&&!u[n]&&(u[n]={href:n,title:$(this).text().replace(/Click to download/i,"").trim()})});u=Object.keys(u).map(function(n){return u[n]});u.length?u.forEach(function(n){t(n)}):i("No link found")},function(n,t,r){t!=="error"||r!=="error"&&r||(r="An error occurred");i(r||t)})})},o=function(n){var u=n.lastIndexOf("?"),r,f;if(u>=0)for(var t=0,i=n.substr(u+1).split("&"),e=i.length;t<e;t++)if(r=i[t].indexOf("="),f=i[t].substr(0,r),f==="o")return aesCrypto.decrypt(i[t].substr(r+1),s)};(function(){var i,f=window.location.get("url");(n=window.location.get("uid"))&&n.length||(n=window.prompt("UID:"));n&&n.length&&(r(f)?(t({href:f,title:"Source page"}),(i=o(f))&&i.length?(t({href:i,title:"Source page #2"}),r(i)?e(i):u(i,"Source page #2")):e(f)||u(f,"Source page")):u(f,"origin ({0})".format(window.location.get("title"))))})()})