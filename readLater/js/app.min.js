"use strict";$().ready(function(){var n=window.nadir.readLater,s,t="readLater",i=function(n){return $(document.createElement("div")).append($(document.createElement("span")).text(n)).html()},r=function(){return window.loading(function(){return $.Deferred(function(t){n.database.database().ref(n.uid).once("value").then(function(t){var r,i=$("#list").empty(),u=t.val(),e;u&&(i=$(document.createElement("ul")).appendTo(i),r=[],$(u).eachProp(function(n,t){var i=$.extend({},t);i.date=new Date(i.date);i.id=n;i.title&&i.title.length||(i.title="<No title>");i.url&&i.url.length||(i.url="");r.push(i)}),r.sort(function(n,t){var i,r;return n.date.getTime?isNaN(i=n.date.getTime())&&(i=n.title):i=n.title,t.date.getTime?isNaN(r=t.date.getTime())&&(r=t.title):r=t.title,i<r?1:i>r?-1:0}),e=["rename",{id:"remove",click:f}],$(r).each(function(n,t){window.nadir.readLater.createLink(i,t,e)}),i.find("li").length?n.loadFavicons(i):i.remove());f()}).catch(function(n){$.alert(n.message||n)}).finally(function(){t.resolve()})}).promise()},"Loading links...")},u=function(u,f,e,o,h){window.loader.message("Logging in...");window.loader.show();n.database.auth().signInWithEmailAndPassword(u,f).then(function(h){e?window.localStorage.setItem(t,window.JSON.stringify({username:u,password:f,rememberMe:!0})):window.localStorage.removeItem(t);$(".email").button("option","label",i(s=h.user.email)).fadeIn();$(".refresh").fadeIn();n.uid=h.user.uid;o&&o();window.loader.hide();r()}).catch(function(n){window.loader.hide();$.alert(n.description||n.message||n).then(h)})},f=function(){var n=$("#list").find("li").length;$(".header-text").text(("Read later links"+(n?" ({0})":String.empty)).format(n.toLocaleString()));$(".no-link")[n?"fadeOut":"fadeIn"]()},e=function(n,t,i){$(".loginButton").button().off().on({click:function(){return u($("#username").val(),$("#password").val(),$("#rememberMe").prop("checked"),function(){$(".loginDialog").dialog("close")}),!1}});$("#username").val(n);$("#password").val(t);$("#rememberMe").prop("checked",i);$(".loginDialog").dialog({hide:!0,minWidth:$(window).width()*.5,modal:!0,show:!0})},o=function(n){var i=window.localStorage.getItem(t);i=i&&i.length?window.JSON.parse(i):{};!n&&i.username&&i.username.length?u(i.username,i.password,i.rememberMe,undefined,function(){e(i.username,i.password,i.rememberMe)}):e(i.username,i.password,i.rememberMe)};window.loader.value(!1);$(".email").button({icons:{primary:"ui-icon-key"}}).on({click:function(){o(!0)}});$(".refresh").button({icons:{primary:"ui-icon-refresh"},label:i("Refresh")}).on({click:function(){r()}});o()})