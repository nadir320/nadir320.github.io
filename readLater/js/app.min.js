"use strict";$().ready(function(){var n=window.nadir.readLater,o,t="readLater",i=function(){return window.loading(function(){return $.Deferred(function(t){n.database.database().ref(n.uid).once("value").then(function(t){var r,i=$("#list").empty(),f=t.val(),e;f&&(i=$(document.createElement("ul")).appendTo(i),r=[],$(f).eachProp(function(n,t){var i=$.extend({},t);i.date=new Date(i.date);i.id=n;i.title&&i.title.length||(i.title="<No title>");i.url&&i.url.length||(i.url="");r.push(i)}),r.sort(function(n,t){var i,r;return n.date.getTime?isNaN(i=n.date.getTime())&&(i=n.title):i=n.title,t.date.getTime?isNaN(r=t.date.getTime())&&(r=t.title):r=t.title,i<r?1:i>r?-1:0}),e=["rename",{id:"remove",click:u}],$(r).each(function(n,t){window.nadir.readLater.createLink(i,t,e)}),i.find("li").length?n.loadFavicons(i):i.remove());u()}).catch(function(n){$.alert(n.message||n)}).finally(function(){t.resolve()})}).promise()},"Loading links...")},r=function(r,u,f,e,s){window.loader.message("Logging in...");window.loader.show();n.database.auth().signInWithEmailAndPassword(r,u).then(function(s){f?window.localStorage.setItem(t,window.JSON.stringify({username:r,password:u,rememberMe:!0})):window.localStorage.removeItem(t);$(".email").button("option","label",o=s.user.email).fadeIn();$(".refresh").fadeIn();n.uid=s.user.uid;e&&e();window.loader.hide();i()}).catch(function(n){window.loader.hide();$.alert(n.description||n.message||n).then(s)})},u=function(){var n=$("#list").find("li").length;$(".title-text").text(("Read later links"+(n?" ({0})":String.empty)).format(n.toLocaleString()));$(".no-link")[n?"fadeOut":"fadeIn"]()},f=function(n,t,i){$(".loginButton").button().off().on({click:function(){return r($("#username").val(),$("#password").val(),$("#rememberMe").prop("checked"),function(){$(".loginDialog").dialog("close")}),!1}});$("#username").val(n);$("#password").val(t);$("#rememberMe").prop("checked",i);$(".loginDialog").dialog({hide:!0,minWidth:$(window).width()*.5,modal:!0,show:!0})},e=function(n){var i=window.localStorage.getItem(t);i=i&&i.length?window.JSON.parse(i):{};!n&&i.username&&i.username.length?r(i.username,i.password,i.rememberMe,undefined,function(){f(i.username,i.password,i.rememberMe)}):f(i.username,i.password,i.rememberMe)};window.loader.value(!1);$(".email").button({icons:{primary:"ui-icon-key"}}).on({click:function(){e(!0)}});$(".refresh").button({icons:{primary:"ui-icon-refresh"}}).on({click:function(){i()}});e()})