"use strict";(function(){var t;window.HTMLCanvasElement.fromImage||(window.HTMLCanvasElement.fromImage=function(n){var t=document.createElement("canvas"),i=t.getContext("2d");return t.width=n.width,t.height=n.height,i.drawImage(n,0,0),i});t=window.HTMLCanvasElement.prototype;t.clear||(t.clear=function(){this.getContext("2d").clearRect(0,0,canvas.width,canvas.height)});t.getImage||(t.getImage=function(n){var t;(t=new Image).addEventListener("load",function(){n.call(this,this)});this.toBlob?this.toBlob(function(n){t.src=URL.createObjectURL(n)}):t.src=this.toDataURL()});var n=window.CanvasRenderingContext2D.prototype,i=function(n,t){return t=t||0,{r:n[t+0],g:n[t+1],b:n[t+2],a:n[t+3]}},r=function(n,t,i){n[t+0]=i.r||0;n[t+1]=i.g||0;n[t+2]=i.b||0;n[t+3]=i.a!==undefined?i.a:255};n.floodFill||(n.floodFill=function(n,t,u,f,e,o){var h,v,p,d,w,l,a,c,o,nt,tt,it,g,b,y,s,k,e;if(d=0,l={a:u.a===undefined?255:u.a||0,r:u.r||0,g:u.g||0,b:u.b||0},f=f||0,v=function(n){var t;if(n>=0&&n<g){if((t=i(b,n)).a===0)return!0;if(s.a===l.a&&s.r===l.r&&s.g===l.g&&s.b===l.b)return!1;if(s.a===t.a&&s.r===t.r&&s.g===t.g&&s.b===t.b||f&&Math.abs(s.a-t.a)<=f&&Math.abs(s.r-t.r)<=f&&Math.abs(s.g-t.g)<=f&&Math.abs(s.b-t.b)<=f)return!0}return!1},p=function(n){return v(n)?(r(b,n,l),d++,!0):!1},g=(b=(nt=this.getImageData(0,0,e=e||this.canvas.clientWidth,o=o||this.canvas.clientHeight)).data).length,h=4*e,y=[a=4*(e*t+n)],s=i(b,a),v(a)){while(y.length)if(p(a=y.pop())){for(w=k=a,tt=(it=parseInt(a/h)*h)+h;(k-=4)>it&&p(k););while((w+=4)<tt&&p(w));for(c=k+4;c<w;c+=4)c-h>=0&&v(c-h)&&y.push(c-h),c+h<g&&v(c+h)&&y.push(c+h)}this.putImageData(nt,0,0)}return d});n.getPixel||(n.getPixel=function(n,t){var r=this.getImageData(n,t,1,1),u=r.data;return i(u)});n.getPixels||(n.getPixels=function(n,t,r,u){for(var f,h=this.getImageData(n||0,t||0,r||0,u||0),c=h.data,s=new Array(u),o,l=4*r,e=0;e<u;e++){for(o=new Array(r),f=0;f<r;f++)o[f]=i(c,l*e+4*f);s[e]=o}return s});n.setPixel||(n.setPixel=function(n,t,i){var u=this.getImageData(n,t,1,1),f=u.data;r(f,0,i);this.putImageData(u,n,t)});n.setPixels||(n.setPixels=function(n,t,i){for(var s=n.length,e,o,h,c,l,f=0,u=0;u<s;u++)f=Math.max(f,n[u].length);for(o=this.getImageData(t=t||0,i=i||0,f,n.length),h=o.data,l=4*f,u=0;u<s;u++)for(f=(c=n[u]).length,e=0;e<f;e++)r(h,l*u+4*e,c[e]);this.putImageData(o,t,i)});window.Image.createFromPixels||(window.Image.createFromPixels=function(n,t){var i,f,r,u=0;for((i=document.createElement("canvas")).height=f=n.length,r=0;r<f;r++)u=Math.max(u,n[r].length);i.width=u;i.getContext("2d").setPixels(n);i.getImage(t)});window.Image.getFragment||(window.Image.getFragment=function(n,t,i,r,u){var f,e;e=(f=document.createElement("canvas")).getContext("2d");f.width=i;f.height=r;e.drawImage(this,-n,-t);f.getImage(u)});window.Image.getPixels||(window.Image.getPixels=function(n,t,i,r){return window.HTMLCanvasElement.fromImage(this).getPixels(n||0,t||0,i||this.width,r||this.height)});window.Image.stackImagePixels||(window.Image.stackImagePixels=function(n,t){var i=[];return n.map(function(n){i=i.concat(window.HTMLCanvasElement.fromImage(n).getPixels(0,0,n.width,n.height))}),window.Image.createFromPixels(i,t)});window.Image.stackImages||(window.Image.stackImages=function(n,t){var i,u,r=0,f=0,e=0;n.map(function(n){r=Math.max(r,n.width);f+=n.height});u=(i=document.createElement("canvas")).getContext("2d");i.width=r;i.height=f;n.map(function(n){u.drawImage(n,0,e);e+=n.height});i.getImage(t)})})()