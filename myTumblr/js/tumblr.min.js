"use strict";window.tumblr=function(){var r="XxD0MaqyUiqkaTATyhoi1T2uZDgwYxX8s0UUywYtzgd8XrYKdr",u="https://api.tumblr.com/v2/blog/{0}/{1}",o="https://a.tumblr.com/{0}o1.mp3",s="tB4jfzUgKbLkqQwE2ENQZHu6YBd2IYyScTwsmZwN61HRaQTdO9",h="PIgTwsjFPh3E3gq2LsBiiF0qOhAq1TByMDKrTICkwTWuSmgtip",f=OAuth({consumer:{key:r,secret:"Hrgv1NQS2lwRe9uxmJ8jI6E1rowS7LKC18QO5pCACpqOsu3DXU"},signature_method:"HMAC-SHA1",hash_function:function(n,t){return CryptoJS.HmacSHA1(n,t).toString(CryptoJS.enc.Base64)}}),t=function(n){var t=[];return n&&n.length&&(t=$(document.createElement("div")).html(n.replace(/ src="/gi,' data-src="')).find("img").map(function(n,t){var r,u,s,i,f,e=(t=$(t)).data("src"),h=t.attr("srcset"),o;if(window.tumblr.isPhotoURL(e,i={}))return i=i.matches,s=parseInt(t.data("orig-height"))||parseInt(t.parent().data("orig-height"))||0,o=parseInt(t.data("orig-width"))||parseInt(t.parent().data("orig-width"))||0,r=[f={height:s,url:e=window.location.sameProtocol(e),width:o}],i&&i.length>1&&!!(u=parseInt(i[i.length-1]))&&u!==1280&&o>u&&(f.width=u,f.height=Math.floor(f.height*u/o),i.isPhoto&&r.push(f={height:s,url:e=e.replace("_"+u+".","_1280."),width:o})),h&&h.length&&($(h.split(",")).each(function(n,t){let e=t.split(" "),u=e.pop(),o=window.location.sameProtocol(e.pop()),i,s=!1;if(u=parseInt(u.substr(0,u.length-1))){for(var f=0;f<r.length;f++)if(r[f].width===u){s=!0;break}s||(i=o.split("/"),i.pop(),i=i.pop(),i=i.split("_")[0],i=parseInt(i.split("x").pop()),r.push({height:i,url:o,width:u}))}}),r.sort(l)),{alt_sizes:r,download_url:e,original_size:f,photoID:window.guid()}})),$.makeArray(t)},e=function(n,t,i){var r,u=this.photos[n];return $(u.alt_sizes).each(function(n){if(this.width<=t&&(!i||this.height<=i))return r=n,!1}),r===undefined&&(r=u.alt_sizes.length-1),r},c=function(t,i,u){var e=$.Deferred(),c=function(){return $.Deferred(function(e){var o,c=function(i,r,f){var s=window.formatAjaxError(r,f),h=function(){n.ignoreErrors||u&&(u.disabled||u.login_required&&!n.isLoginSupported)||$.toast.error(String.format("{0}: {1}",t,s));window.console&&window.console.log&&window.console.log(s);e.reject.apply(this,c)},c=arguments;r==="parsererror"&&n.proxy?($.toast.warning(s),n.proxy.ajax({data:o,dataType:"json",url:t}).then(e.resolve,function(){h()})):h()};u&&u.login_required&&n.isLoginSupported?$.ajax({data:i,headers:f.toHeader(f.authorize({data:i,url:t,method:"GET"},{key:s,secret:h})),url:t}).then(e.resolve,c):$.ajax({crossDomain:!0,data:o=$.extend({},i,{api_key:r,_:$.now()}),dataType:"jsonp",url:t}).then(e.resolve,c)}).promise()},o=function(){return $.when(c()).then(function(n){e.resolve(n)},function(){e.reject()})};return DEBUG?window.setTimeout(function(){o()},DEBUG_TIMEOUT):o(),e.promise()},i=function(n,t,i,r){return c(String.format(u,n,t),i,r)},l=function(n,t){return-(n.width-t.width)},n={getBlog:function(r){var c={},h,l,f,s;for($.isPlainObject(r)||(r={url:r});r.url.length&&r.url[r.url.length-1]==="/";)r.url=r.url.substr(0,r.url.length-1);for(r.url+="/",f=r.name||window.location.noProtocol(r.url);f.length&&f[f.length-1]==="/";)f=f.substr(0,f.length-1);for(r.name=f,s=0;s<tumblr.AVATAR_SIZES.length;s++)c[tumblr.AVATAR_SIZES[s]]=window.location.sameProtocol(String.format(u,r.name,"avatar/"+tumblr.AVATAR_SIZES[s]));return h=$.extend({},r),delete h.url,{data:r,getFollowers:function(){return i(r.name,"followers",undefined,this.data)},getInfo:function(t){t&&!this.data.login_required&&(this.data.login_required=!0);var u=$.Deferred(),f=function(n){u.resolve({blogURL:r.url,dataLength:n||0,name:r.name,url:r.url})};return $.when(i(r.name,"info",undefined,this.data)).then(function(t){var i=window.JSON.stringify(t).length;t.meta.status===200?u.resolve(l=$.extend({},t.response.blog,{archiveURL:window.tumblr.getArchiveURL(r.url),avatarURLs:c,blogURL:r.url,dataLength:i,description:t.response.blog.description.purify(),exists:!0,name:r.name,updated:new Date(t.response.blog.updated*1e3),url:t.response.blog.url.match(/www\.tumblr\.com\/blog\/view\//gi)?r.url:t.response.blog.url},h,{title:t.response.blog.title||r.name})):(n.ignoreErrors||$.toast.error(String.format("{0}: {1}",r.url,t.meta.msg)),f(i))},function(){f()}),u.promise()},getLikes:function(){return i(r.name,"likes",undefined,this.data)},getPosts:function(n,u,f,s,h,c,a){var v={limit:s,notes_info:!!a,reblog_info:!!c,offset:n?n*s:0};return h&&h.length&&(v.tag=h,f=undefined),$.when(i(r.name,"posts"+(f?"/"+f:""),v,this.data)).then(function(n){var i,r=0;return u&&(f?(u.posts_per_type=u.posts_per_type||{},u.posts_per_type[f]=n.response.total_posts):u.posts=n.response.total_posts,u.updated=new Date(n.response.blog.updated*1e3)),i=$(n.response.posts).map(function(n){var s,h,f,i;n-=r;i=$.extend({},this,{blog:u||l,fullIndex:v.offset+n,index:n,summary:(this.summary||String.empty).purify(),timestamp:new Date(this.timestamp*1e3)});this.dismissal!==undefined&&(delete i.dismissal,delete i.index,delete i.fullIndex,i.sticky=!0,r++);switch(this.type){case"audio":(s=i.audio_url)&&s.length&&(h=window.location.noHash(s.split("/").pop()),h.indexOf(".")<0&&(s=String.format(o,h)),i.download_url=i.audio_url=window.location.sameProtocol(s),i.album_art&&i.album_art.length&&(i.album_art=window.location.sameProtocol(i.album_art)));break;case"photo":$(i.photos).each(function(n){var t=this;t.index=n;t.original_size.url.match("_1280.")||($(t.alt_sizes).each(function(){if(this.url.match("_1280."))return t.original_size.url=this.url,t.corrected=!0,!1}),t.corrected||t.original_size.url.match("_500.")&&$(t.alt_sizes).each(function(n){if(this.url.match("_500.")&&n)return t.original_size.url=t.alt_sizes[0].url=this.url.replace("_500.","_1280."),t.corrected=!0,!1}));t.download_url=t.original_size.url=window.location.sameProtocol(t.original_size.url);t.photoID=i.id.toString()+"_"+t.index.toString();$(t.alt_sizes).each(function(){this.url=window.location.sameProtocol(this.url)});t.corrected&&(i.corrected=!0)});i.original_photos=i.photos;i.getBestFitPhotoIndex=e;break;case"video":default:i.video_url&&i.video_url.length?i.video_url=window.location.sameProtocol(i.video_url):(this.player&&this.player.length?f=$(document.createElement("div")).html(this.player[this.player.length-1].embed_code).find("video>source"):(f=this.body,f&&f.length||(f=this.answer),f&&f.length&&(f=$(document.createElement("div")).html(f.replace(/ src="/gi,' data-src="')),f=f.find("video>source").add(f.find("video[data-src]")))),f&&f.length&&(i.videoType=f.attr("type"),i.video_url=window.location.sameProtocol(f.attr("src")||f.data("src"))));(i.download_url=i.video_url)&&(i.actual_type="video")}return i.photos=(i.photos||[]).concat(t(this.body)).concat(t(this.caption)).concat(t(this.answer)).concat(t(this.description)),i.photos&&(i.photos.length?i.getBestFitPhotoIndex||(i.getBestFitPhotoIndex=e):delete i.photos),i}).get(),i.dataLength=window.JSON.stringify(n).length,i})},name:r.name,url:r.url}},ignoreErrors:!1,isLoginSupported:window.CryptoJS!==undefined};return n};window.tumblr.AVATAR_SIZES=[16,24,30,40,48,64,96,128,512];window.tumblr.MAX_POSTS_PER_PAGE=20;window.tumblr.MEDIAURL1=/\d{2}\.media\.tumblr\.com\/.*\/.*\/s(\d{1,4})x(\d{1,4})\//i;window.tumblr.MEDIAURL2=/\d{2}\.media\.tumblr\.com\//i;window.tumblr.PHOTOURL=/\.tumblr\.com\/.*tumblr_.*_(\d{1,4})\./i;window.tumblr.POST_TYPES=[{description:"All posts",value:""},{description:"Photos",value:"photo"},{description:"Videos",value:"video"},{description:"Texts",value:"text"},{description:"Answers",value:"answer"},{description:"Quotes",value:"quote"},{description:"Links",value:"link"},{description:"Chats",value:"chat"},{description:"Audio",value:"audio"}];window.tumblr.getArchiveURL=function(n){if(n&&n.length){while(n.slice(-1)==="/")n=n.substr(0,n.length-1);return window.location.sameProtocol(n+"/archive/")}};window.tumblr.isPhotoURL=function(n){var t=n.match(window.tumblr.PHOTOURL);return t?(arguments.length>1&&(arguments[1].isPhoto=!0,arguments[1].matches=t),!0):(t=n.match(window.tumblr.MEDIAURL1),t)?(arguments.length>1&&(t.pop(),arguments[1].matches=t),!0):!!n.match(window.tumblr.MEDIAURL2)}