"use strict";(function(){var f={Cervello:{url:"audio/cervello.mp3"},Cuore:{url:"audio/cuore.mp3"},Muscoli:{url:"audio/muscoli.mp3"},Ossa:{url:"audio/ossa.mp3"},Polmoni:{url:"audio/polmoni.mp3"},Seno:{url:"audio/seno.mp3"},Utero:{url:"audio/utero.mp3"}},i={duration:0,tracks:0},n,t=function(n){return Array.from(document.getElementsByClassName(n))},r=function(n){t("play").forEach(function(t){n(t)})},u=function(n){t("stop").forEach(function(t){n(t)})},e,o;r(function(n){n.disabled=!0});u(function(n){n.disabled=!0});e=Array.from(document.getElementsByClassName("grid")).pop();o=function(t){var r=function(n){t.element.innerText=t.name+": "+n.message;t.element.classList.add("error")};return fetch(t.url).then(function(u){return n||(n=new AudioContext,n.suspend()),u.arrayBuffer().then(function(u){return n.decodeAudioData(u).then(function(r){i.duration=Math.max(i.duration,r.duration);var u=n.createBufferSource(),f=n.createGain();u.connect(f);f.connect(n.destination);u.buffer=r;u.loop=!0;t.element.innerText=t.name;t.element.addEventListener("click",function(){f.gain.value===0?(f.gain.value=1,t.element.classList.remove("muted")):(f.gain.value=0,t.element.classList.add("muted"))});u.start();t.source=u;i[t.name]=t;i.tracks++}).catch(r)}).catch(r)}).catch(r)};t("start").forEach(function(s){s.addEventListener("click",function(){var s=[];t("start").forEach(function(n){n.innerText="..."});Object.keys(f).forEach(function(n){var t=document.createElement("button"),i;t.setAttribute("type","button");t.classList.add("image-button");t.classList.add("audio");i=f[n];i.name=n;i.element=t;s.push(o(i));t.innerText="Caricamento di '"+n+"'...";e.appendChild(t)});Promise.all(s).then(function(){t("position").forEach(function(n){n.max=Math.ceil(i.duration*100)});r(function(t){t.disabled=!1;t.addEventListener("click",function(){n.resume();r(function(n){n.disabled=!0});u(function(n){n.disabled=!1})})});u(function(t){t.addEventListener("click",function(){n.suspend();r(function(n){n.disabled=!1});u(function(n){n.disabled=!0})})});setTimeout(function(){t("play").pop().click()},1e3)}).finally(function(){t("backdrop").concat(t("starter")).forEach(function(n){n.style.display="none"})})})});window.setInterval(function(){n&&Array.from(document.getElementsByClassName("position")).forEach(function(t){t.value=Math.floor(n.currentTime%i.duration*100)})},25)})()