(function(){window.firebaseDataStore=function(n){var l,u,h=function(i,r){window.jQuery(t).trigger("error",{error:String.format("Error accessing Firebase data-store {0}{1}",n,r&&r.length?String.format(": {0}",r):".")});i.reject(r)},r=function(n){return window.jQuery.Deferred(function(i){var r=window.setTimeout(function(){h(i)},t.timeout||window.jQuery.ajaxSetup().timeout);return n(function(n,t,u,f){window.clearTimeout(r);e(t,u,f);i.resolve(n)},function(n){window.clearTimeout(r);h(i,n)})})},i,t,e=function(n,i,r){window.jQuery(t).trigger("message",{length:r,message:t.messages[n]||String.format("Firebase data-store: call to '{0}' successful ({1} received).",i,window.formatFileSize(r))})},c=function(n,t,i){var r=[],s=new Firebase(n),e;l||(u&&u.length?(o||(o=new FirebaseTokenGenerator(u)),r.push(o.createToken({uid:window.jQuery.now()})),e="authWithCustomToken"):f&&f.length&&_password&&_password.length?(r.push({email:f,password:_password}),e="authWithPassword"):e="authAnonymously",r.push(function(n){n?i(n.message):t(s)}),r.push({remember:"none"}),s[e].apply(s,r))},o,s="https://{0}.firebaseio.com/".format(isNaN(parseInt(n))?n:"glowing-fire-{0}".format(n)),f;return t={addItem:function(n,u){return n?t.setItem(n,u):(u===undefined&&(u=null),u!==null?r(function(n,t){var r=i.push(u,function(i){i?t():n(r.key(),"updated","push",-1)})}):t.removeItem(n))},changePassword:function(n,u,f){return r(function(r,o){e("changingPassword");i.changePassword({email:(n||"").toLowerCase(),oldPassword:u,newPassword:f},function(n){var i;if(n){switch(n.code){case"INVALID_PASSWORD":i=t.messages.invalidPassword;break;case"INVALID_USER":i=t.messages.invalidUsername}o(i||n.message)}else r(undefined,"passwordChanged","changePassword",-1)})})},getItem:function(n){return window.jQuery.when(this.list()).then(function(t){return t[n]})},close:function(){i=null},isOpen:function(){return!!i},list:function(){return r(function(n){i.once("value",function(t){var i=t.val()||{};n(i,"downloaded","value",window.JSON.stringify(i).length*1.04)})})},messages:{changingPassword:"Changing password...",connected:"Connected",connecting:"Connecting...",downloaded:"Data downloaded",downloading:"Downloading latest data",invalidPassword:"Invalid password",invalidUsername:"Invalid user name",passwordChanged:"Password changed successfully",reset:"Data storage reset",updated:"Data storage updated"},open:function(n,t,o,h){return u=o,f=(n||"").toLowerCase(),_password=t,h&&(s+=h+"/"),r(function(n,t){e("connecting");c(s,function(t){i=t;n(undefined,"downloading","open",-1)},t)})},removeItem:function(n){return t.setItem(n,null)},setItem:function(n,t){return t===undefined&&(t=null),r(function(i,r){c(s+n+"/",function(n){n.set(t,function(n){n?r():i(undefined,t?"updated":"reset","set",-1)})},r)})}}};window.firebaseDataStore.getKey=function(n){return n.replace(/(\.|\#|\$|\[|\]|\@)/g,"_")}})()